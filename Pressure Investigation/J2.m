function JJ = J2(lambda, a)
%JJ: 3*3*N
[~,n]  = size(lambda);
u1     = [lambda+a(1).^2; lambda+a(2).^2; lambda+a(3).^2];
u2     = [a(1)^2-a(2)^2; a(1)^2-a(3)^2; a(2)^2-a(3)^2];
u3     = repmat(u2,1,n);
u      = cat(1,u1,u3);
u= round(u,4);
delta  = (u(1,:).*u(2,:).*u(3,:)).^0.5;
k      = J1(lambda, a)./(2*pi*a(1)*a(2)*a(3));
v      = zeros(3,3,n);
for i=1:3
    for j=1:3
        if i~=j
           v(i,j,:)= (k(i,:)-k(j,:))/(a(j)^2-a(i)^2);
        end
    end
end
v(1,1,:) = (-2/3)./u(1,:)./delta + ((2*a(1)^2-a(2)^2-a(3)^2)/3)...
           ./u(5,:)./u(4,:).*k(1,:) - (1/3)./u(4,:).*k(2,:) - ...
           (1/3)./u(5,:).*k(3,:);
v(2,2,:) = (-2/3)./u(2,:)./delta - ((2*a(2)^2-a(1)^2-a(3)^2)/3)...
           ./u(6,:)./u(4,:).*k(2,:) + (1/3)./u(4,:).*k(1,:) - ...
           (1/3)./u(6,:).*k(3,:);    
v(3,3,:) = (-2/3)./u(3,:)./delta + ((2*a(3)^2-a(1)^2-a(2)^2)/3)...
           ./u(5,:)./u(6,:).*k(3,:) + (1/3)./u(5,:).*k(1,:) + ...
           (1/3)./u(6,:).*k(2,:);
JJ      = (2*pi*a(1)*a(2)*a(3)).*v; 
end